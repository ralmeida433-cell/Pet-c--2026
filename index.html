<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <title>Hotel Pet C√Å - Sistema Moderno de Gerenciamento</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/mobile.css">

    <meta name="description" content="Sistema moderno de gerenciamento para Hotel Pet C√Å - Aplicativo Nativo Android">
    <meta name="theme-color" content="#2563eb">
    
    <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>

<body>
    <div id="loading" class="loading-screen">
        <div class="loading-content">
            <div class="pet-logo-animated">
                <i class="fas fa-paw"></i>
            </div>
            <h2>Hotel Pet C√Å</h2>
            <p>Sistema Moderno de Gerenciamento</p>
            <div class="loading-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </div>

    <header class="mobile-header">
        <div class="mobile-header-left">
            <button class="header-menu-btn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
            <span class="mobile-header-title" id="mobile-page-title">Hotel Pet C√Å</span>
        </div>
        <div class="mobile-nav-controls">
            <button class="nav-btn" id="nav-back-btn" onclick="window.hotelPetApp.goBack()" disabled>
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="nav-btn" id="nav-forward-btn" onclick="window.hotelPetApp.goForward()" disabled>
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </header>

    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <img src="css/logo.png" alt="Hotel Pet C√Å" class="logo-image-only"
                    onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                <div class="logo-fallback" style="display: none;">
                    <i class="fas fa-paw"></i>
                </div>
            </div>
            <button class="sidebar-toggle" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
        </div>

        <ul class="sidebar-menu">
            <li class="menu-item active" data-section="overview">
                <a href="#" onclick="navigateToSection('overview')">
                    <i class="fas fa-eye"></i>
                    <span>Vis√£o Geral</span>
                </a>
            </li>
            <li class="menu-item" data-section="dashboard">
                <a href="#" onclick="navigateToSection('dashboard')">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="menu-item" data-section="animals">
                <a href="#" onclick="navigateToSection('animals')">
                    <i class="fas fa-dog"></i>
                    <span>Animais</span>
                </a>
            </li>
            <li class="menu-item" data-section="reservations">
                <a href="#" onclick="navigateToSection('reservations')">
                    <i class="fas fa-calendar-check"></i>
                    <span>Reservas</span>
                </a>
            </li>
            <li class="menu-item" data-section="inventory">
                <a href="#" onclick="navigateToSection('inventory')">
                    <i class="fas fa-boxes"></i>
                    <span>Controle de Estoque</span>
                </a>
            </li>
            <li class="menu-item" data-section="reports">
                <a href="#" onclick="navigateToSection('reports')">
                    <i class="fas fa-chart-bar"></i>
                    <span>Relat√≥rios</span>
                </a>
            </li>
        </ul>
    </nav>

    <div class="sidebar-overlay" onclick="closeSidebar()"></div>

    <main class="main-content">
        <div id="app" class="app-container hidden">
            <section id="overview" class="content-section active">
                <div class="page-header">
                    <div class="page-header-content">
                        <h1>Vis√£o Geral</h1>
                        <p>Status em tempo real das acomoda√ß√µes</p>
                    </div>
                </div>
                <div id="kennels-visualization" class="kennels-container"></div>
            </section>

            <section id="dashboard" class="content-section">
                <div class="page-header">
                    <div class="page-header-content">
                        <h1>Dashboard</h1>
                        <p>Vis√£o geral completa do Hotel Pet C√Å</p>
                    </div>
                </div>
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-paw"></i></div>
                        <div class="stat-info"><h3 id="total-animals">0</h3><p>Animais Cadastrados</p></div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-bed"></i></div>
                        <div class="stat-info"><h3 id="active-reservations">0</h3><p>Reservas Ativas</p></div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-dollar-sign"></i></div>
                        <div class="stat-info"><h3 id="monthly-revenue">R$ 0,00</h3><p>Receita do M√™s</p></div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-percentage"></i></div>
                        <div class="stat-info"><h3 id="occupancy-rate">0%</h3><p>Taxa de Ocupa√ß√£o</p></div>
                    </div>
                </div>
                <div class="charts-container">
                    <div class="chart-card"><h3>Reservas por M√™s</h3><div class="chart-wrapper"><canvas id="monthlyChart"></canvas></div></div>
                    <div class="chart-card"><h3>Ocupa√ß√£o Atual</h3><div class="chart-wrapper"><canvas id="kennel-chart"></canvas></div></div>
                </div>
                <div class="recent-reservations">
                    <h3>Reservas Recentes</h3>
                    <div id="recent-reservations-list" class="dashboard-res-list">
                        <!-- JS populate here -->
                    </div>
                </div>
            </section>

            <section id="animals" class="content-section">
                <div class="page-header">
                    <div class="page-header-content">
                        <h1>Gerenciamento de Animais</h1>
                        <p>Cadastro e controle de todos os pets</p>
                    </div>
                    <div class="page-header-actions">
                        <button class="btn btn-primary" id="add-animal-btn"><i class="fas fa-plus"></i> Novo Animal</button>
                    </div>
                </div>
                <div class="filters-container">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="animal-search" placeholder="Buscar animais...">
                        <button class="voice-search-btn" onclick="startVoiceSearch('animal-search')"><i class="fas fa-microphone"></i></button>
                    </div>
                    <select id="kennel-filter">
                        <option value="">Todos</option>
                        <option value="C√ÉO">C√£es</option>
                        <option value="GATO">Gatos</option>
                    </select>
                </div>
                <div class="table-container">
                    <!-- A lista de animais ser√° renderizada aqui pelo AnimalsManager -->
                </div>
            </section>

            <section id="animal-profile" class="content-section">
                <div class="page-header">
                    <div class="page-header-content">
                        <h1>Perfil do Pet</h1>
                        <p>Hist√≥rico completo e dados de sa√∫de</p>
                    </div>
                    <div class="page-header-actions">
                        <button class="btn btn-secondary" onclick="navigateToSection('animals')"><i class="fas fa-arrow-left"></i> Voltar</button>
                    </div>
                </div>
                <div id="animal-profile-content">
                    <!-- Conte√∫do do perfil ser√° injetado aqui -->
                </div>
            </section>

            <section id="reservations" class="content-section">
                <div class="page-header">
                    <div class="page-header-content">
                        <h1>Gerenciamento de Reservas</h1>
                        <p>Controle completo de hospedagens</p>
                    </div>
                    <div class="page-header-actions">
                        <button class="btn btn-primary" id="add-reservation-btn"><i class="fas fa-plus"></i> Nova Reserva</button>
                    </div>
                </div>
                <div class="filters-container">
                    <div class="search-box"><i class="fas fa-search"></i><input type="text" id="reservation-search" placeholder="Buscar reservas..."></div>
                    <div class="quick-filters">
                        <div class="filter-pill active" data-status="">Todas</div>
                        <div class="filter-pill" data-status="ATIVA">Ativas</div>
                        <div class="filter-pill" data-status="FINALIZADA">Finalizadas</div>
                    </div>
                    <select id="status-filter" style="display:none;">
                        <option value="">Todos Status</option>
                        <option value="ATIVA">Ativa</option>
                        <option value="FINALIZADA">Finalizada</option>
                    </select>
                    <input type="month" id="month-filter" class="month-filter-modern">
                </div>
                <div class="table-container">
                    <!-- A lista de cards de reservas ser√° renderizada aqui pelo ReservationsManager -->
                </div>
            </section>

            <section id="inventory" class="content-section">
                <div class="page-header">
                    <div class="page-header-content">
                        <h1>Controle de Estoque</h1>
                        <p>Gerenciamento completo de produtos</p>
                    </div>
                    <div class="page-header-actions">
                        <button class="btn btn-secondary" id="stock-report-btn"><i class="fas fa-file-alt"></i> Relat√≥rio</button>
                        <button class="btn btn-primary" id="add-product-btn"><i class="fas fa-plus"></i> Novo Produto</button>
                    </div>
                </div>
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-boxes"></i></div>
                        <div class="stat-info"><h3 id="total-products">0</h3><p>Total de Produtos</p></div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-exclamation-triangle"></i></div>
                        <div class="stat-info"><h3 id="low-stock-products">0</h3><p>Estoque Baixo</p></div>
                    </div>
                </div>
                <div class="filters-container">
                    <div class="search-box"><i class="fas fa-search"></i><input type="text" id="product-search" placeholder="Buscar produtos..."></div>
                    <select id="category-filter"><option value="">Todas Categorias</option></select>
                    <select id="animal-filter"><option value="">Todos Animais</option></select>
                    <select id="stock-status-filter">
                        <option value="">Todos Status</option>
                        <option value="low">Estoque Baixo</option>
                        <option value="expiring">Vencendo</option>
                    </select>
                </div>
                <div class="table-container">
                    <table id="products-table">
                        <thead>
                            <tr><th>Imagem</th><th>Produto</th><th>Categoria</th><th>Marca</th><th>Animal</th><th>Estoque</th><th>Pre√ßo</th><th>Status</th><th>A√ß√µes</th></tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <section id="reports" class="content-section">
                <div class="page-header">
                    <div class="page-header-content">
                        <h1>Relat√≥rios</h1>
                        <p>An√°lises e estat√≠sticas detalhadas</p>
                    </div>
                </div>
                <div class="reports-grid">
                    <div class="report-card">
                        <h3>Relat√≥rio Mensal</h3>
                        <p>An√°lise detalhada de faturamento e ocupa√ß√£o mensal.</p>
                        <select id="report-month"><option value="">Selecione o m√™s</option></select>
                        <button class="btn btn-secondary" id="generate-monthly-report"><i class="fas fa-file-pdf"></i> Gerar Relat√≥rio</button>
                    </div>
                    <div class="report-card">
                        <h3>Relat√≥rio Anual</h3>
                        <p>Vis√£o consolidada do desempenho ao longo do ano.</p>
                        <select id="report-year"><option value="">Selecione o ano</option></select>
                        <button class="btn btn-secondary" id="generate-yearly-report"><i class="fas fa-chart-line"></i> Gerar Relat√≥rio</button>
                    </div>
                </div>
                <div id="report-content" class="report-content"></div>
            </section>
        </div>
    </main>

    <!-- Modais de Animais e Reservas -->
    <div id="animal-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="animal-modal-title">Novo Animal</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="animal-form">
                <div class="form-group animal-photo-group">
                    <label>Identifica√ß√£o do Animal</label>
                    <div class="photo-selector-modern">
                        <div class="photo-preview-box" onclick="document.getElementById('animal-photo').click()">
                            <img id="photo-preview" src="" alt="Preview" style="display:none;">
                            <div class="photo-placeholder" id="photo-placeholder"><i class="fas fa-camera"></i><span>Adicionar Foto</span></div>
                        </div>
                        <div class="photo-actions-modern">
                            <input type="file" id="animal-photo" accept="image/*" hidden>
                            <button type="button" class="btn-icon-modern" id="start-camera-btn"><i class="fas fa-camera"></i></button>
                        </div>
                    </div>
                </div>
                <div class="form-group"><label>Nome *</label><input type="text" id="animal-name" required></div>
                <div class="form-group"><label>Tutor *</label><input type="text" id="tutor-name" required></div>
                <div class="form-group"><label>Telefone *</label><input type="tel" id="tutor-phone" required></div>
                <div class="form-group"><label>Esp√©cie *</label><select id="animal-species" required><option value="C√ÉO">C√£o</option><option value="GATO">Gato</option></select></div>
                <div class="form-actions"><button type="button" class="btn btn-secondary" id="cancel-animal">Cancelar</button><button type="submit" class="btn btn-primary">Salvar</button></div>
            </form>
        </div>
    </div>

    <div id="reservation-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="reservation-modal-title">Nova Reserva</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="reservation-form">
                <div class="form-row">
                    <div class="form-group"><label>Animal *</label><select id="reservation-animal" required></select></div>
                    <div class="form-group"><label>Alojamento *</label><select id="reservation-accommodation-type" required></select></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>N√∫mero *</label><select id="reservation-kennel-number" required disabled></select></div>
                    <div class="form-group"><label>Di√°ria *</label><input type="number" id="daily-rate" step="0.01" required></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Entrada *</label><input type="date" id="checkin-date" required></div>
                    <div class="form-group"><label>Sa√≠da *</label><input type="date" id="checkout-date" required></div>
                </div>
                <div class="services-selection">
                    <h4>Servi√ßos Adicionais</h4>
                    <div class="services-grid-modern">
                        <label class="service-checkbox-card"><input type="checkbox" id="transport-service"><div class="service-card-content"><i class="fas fa-car"></i><span>Transporte</span><input type="number" id="transport-value" disabled class="mini-price-input"></div></label>
                        <label class="service-checkbox-card"><input type="checkbox" id="bath-service"><div class="service-card-content"><i class="fas fa-shower"></i><span>Banho</span><input type="number" id="bath-value" disabled class="mini-price-input"></div></label>
                        <label class="service-checkbox-card wa-service"><input type="checkbox" id="whatsapp-receipt"><div class="service-card-content"><i class="fab fa-whatsapp"></i><span>Recibo via WhatsApp</span></div></label>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Pagamento *</label><select id="payment-method" required><option value="PIX">PIX</option><option value="CREDITO">Cr√©dito</option></select></div>
                    <div class="form-group"><label>Total</label><input type="text" id="total-value" readonly></div>
                </div>
                <div class="form-actions"><button type="button" class="btn btn-secondary" id="cancel-reservation">Cancelar</button><button type="submit" class="btn btn-primary">Salvar</button></div>
            </form>
        </div>
    </div>

    <!-- Modais de Invent√°rio -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="product-modal-title">Novo Produto</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="product-form">
                <div class="form-group">
                    <label>Imagem do Produto</label>
                    <div class="image-upload-container">
                        <div class="image-upload-area" id="image-upload-area">
                            <div class="upload-placeholder"><i class="fas fa-camera"></i><p>Tirar Foto / Upload</p></div>
                        </div>
                        <div class="image-preview" id="image-preview" style="display:none;">
                            <img id="preview-img" src="" alt="Preview">
                            <button type="button" class="remove-image" id="remove-image">&times;</button>
                        </div>
                        <input type="file" id="product-image" accept="image/*" hidden>
                    </div>
                </div>
                <div class="form-group"><label>Nome do Produto *</label><input type="text" id="product-name" required></div>
                <div class="form-row">
                    <div class="form-group"><label>Marca</label><input type="text" id="product-brand"></div>
                    <div class="form-group"><label>Categoria *</label><select id="product-category" required></select></div>
                </div>
                <div class="form-group"><label>Animais Indicados</label><select id="product-animals" multiple class="form-control"></select></div>
                <div class="form-row">
                    <div class="form-group"><label>Pre√ßo Custo *</label><input type="number" id="product-cost-price" step="0.01" required></div>
                    <div class="form-group"><label>Pre√ßo Venda *</label><input type="number" id="product-sale-price" step="0.01" required></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Estoque Atual *</label><input type="number" id="product-current-stock" required></div>
                    <div class="form-group"><label>Estoque M√≠nimo *</label><input type="number" id="product-min-stock" required></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Peso (kg)</label><input type="number" id="product-weight" step="0.01"></div>
                    <div class="form-group"><label>Data Vencimento</label><input type="date" id="product-expiry-date"></div>
                </div>
                <div class="form-group"><label>Fornecedor</label><input type="text" id="product-supplier"></div>
                <div class="form-group"><label>Descri√ß√£o</label><textarea id="product-description" rows="3"></textarea></div>
                <div class="form-actions"><button type="button" class="btn btn-secondary" id="cancel-product">Cancelar</button><button type="submit" class="btn btn-primary">Salvar</button></div>
            </form>
        </div>
    </div>
    
    <!-- NOVO MODAL DE ADI√á√ÉO DE CANIL -->
    <div id="add-kennel-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="add-kennel-modal-title">Adicionar Novo Alojamento</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="add-kennel-form">
                <input type="hidden" id="new-kennel-type">
                <div class="form-group">
                    <label for="new-kennel-type-display">Tipo de Alojamento</label>
                    <input type="text" id="new-kennel-type-display" readonly disabled>
                </div>
                <div class="form-group">
                    <label for="new-kennel-number">Pr√≥ximo N√∫mero</label>
                    <input type="number" id="new-kennel-number" readonly disabled>
                </div>
                <div class="form-group">
                    <label for="new-kennel-description">Descri√ß√£o (Opcional)</label>
                    <textarea id="new-kennel-description" rows="2"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-add-kennel">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Adicionar Canil</button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL DE HIST√ìRICO PROFISSIONALIZADO -->
    <div id="history-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Novo Registro de Servi√ßo</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="history-form">
                <div class="form-group">
                    <label>Animal</label>
                    <input type="text" id="history-animal-name" readonly disabled>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Servi√ßo *</label>
                        <select id="history-type" required>
                            <option value="BANHO">üßº Banho</option>
                            <option value="TOSA">‚úÇÔ∏è Tosa</option>
                            <option value="VETERIN√ÅRIO">ü©∫ Veterin√°rio</option>
                            <option value="MEDICA√á√ÉO">üíä Medica√ß√£o</option>
                            <option value="HOSPEDAGEM">üè® Hospedagem</option>
                            <option value="OUTRO">üìù Outro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Data *</label>
                        <input type="date" id="history-date" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Respons√°vel</label>
                        <input type="text" id="history-professional" placeholder="Nome do profissional">
                    </div>
                    <div class="form-group">
                        <label>Valor (R$)</label>
                        <input type="number" id="history-value" step="0.01" placeholder="0,00">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Peso (kg)</label>
                        <input type="text" id="history-weight" placeholder="Ex: 12.5kg">
                    </div>
                    <div class="form-group">
                        <label>Comportamento</label>
                        <select id="history-behavior">
                            <option value="Tranquilo">üòä Tranquilo</option>
                            <option value="Agitado">‚ö° Agitado</option>
                            <option value="Assustado">üò® Assustado</option>
                            <option value="Agressivo">üò† Agressivo</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Descri√ß√£o Detalhada *</label>
                    <textarea id="history-description" rows="3" required placeholder="Relate o servi√ßo prestado, produtos usados, etc."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-history">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar Registro</button>
                </div>
            </form>
        </div>
    </div>

    <div class="fab-container" id="fab-container">
        <div class="fab-menu" id="fab-menu">
            <button class="fab-item" onclick="window.reservationsManager.openReservationModal()">
                <i class="fas fa-calendar-check"></i><span>Reserva</span>
            </button>
            <button class="fab-item" onclick="window.animalsManager.openAnimalModal()">
                <i class="fas fa-dog"></i><span>Animal</span>
            </button>
        </div>
        <button class="fab-main" id="fab-main"><i class="fas fa-plus"></i></button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/storage-service.js"></script>
    <script src="js/database.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/animals.js"></script>
    <script src="js/reservations.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/kennels.js"></script>
    <script src="js/inventory.js"></script>
    <script src="js/backup.js"></script>
    <script src="js/features.js"></script>
    <script src="js/animal-profile.js"></script> <!-- NOVO SCRIPT -->
    <script src="js/app.js"></script>

    <script>
        function navigateToSection(sectionName) { if (window.hotelPetApp) window.hotelPetApp.navigateToSection(sectionName); }
        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); document.querySelector('.sidebar-overlay').classList.toggle('active'); }
        function closeSidebar() { document.getElementById('sidebar').classList.remove('open'); document.querySelector('.sidebar-overlay').classList.remove('active'); }

        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('loading').classList.add('fade-out');
                setTimeout(() => {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('app').classList.remove('hidden');
                    document.getElementById('app').classList.add('visible');
                }, 800);
            }, 1000);
        });
    </script>
</body>
</html>